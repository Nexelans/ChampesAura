# Fichier: render.yaml
# Définit l'infrastructure pour Render.com

services:
  # Service Web pour l'API FastAPI
  - type: web
    name: golf-api
    runtime: python
    region: frankfurt # ou une autre région, ex: oregon
    plan: free # Plan gratuit de Render
    # Indique à Render comment installer les dépendances
    buildCommand: "poetry install --no-root"
    # La commande de migration est maintenant combinée avec la commande de démarrage
    startCommand: "alembic upgrade head && uvicorn app.main:app --host 0.0.0.0 --port $PORT"
    envVars:
      - key: DATABASE_URL
        fromDatabase:
          name: golf-db # Doit correspondre au nom de la base de données ci-dessous
          property: connectionString
      - key: PYTHON_VERSION
        value: 3.11.8

databases:
  # Base de données PostgreSQL
  - name: golf-db
    plan: free # Plan gratuit de Render
    # postgresqlVersion: 15 # Vous pouvez spécifier une version si besoin

